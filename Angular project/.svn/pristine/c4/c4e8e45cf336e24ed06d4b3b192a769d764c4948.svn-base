<!-- Page Header-->
<header class="page-header">
	<div class="container-fluid">
		<!-- <h2 class="no-margin-bottom">MIS for {{(reportDetails | async)?.repName}}</h2> -->
		<h2 class="no-margin-bottom">MIS for {{reportName}}</h2>
	</div>
</header>
<!-- Dashboard Counts Section-->
<section class="dashboard-counts no-padding-bottom">
	<div class="container-fluid" *ngIf="reportMessage != undefined">
		<div class="col-lg-12">
			<div class="card">
				<div class="card-header" style="background-color: rgb(239, 126, 62,0.9)">
					<h4 style="color: white;">Note</h4>
				</div>
				<div class="card-body">
					{{reportMessage}}
				</div>
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<div class="col-lg-12" [ngSwitch]="reportType">

			<app-mis-sel-off *ngSwitchCase="'1'" [soList]="soDOSAList" [doList]="doList" [saList]="saList"
				[buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(showReport)="onShowReport($event)">
			</app-mis-sel-off>

			<app-mis-sel-off-date-range *ngSwitchCase="'2'" [soList]="soDOSAList" [doList]="doList"
				[buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-date-range>

			<app-mis-sel-off-date-range-consolidate *ngSwitchCase="'3'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-date-range-consolidate>

			<app-mis-sel-off-consolidate *ngSwitchCase="'4'" [soList]="soDOSAList" [doList]="doList" [saList]="saList"
				[buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(showReport)="onShowReport($event)">
			</app-mis-sel-off-consolidate>

			<app-mis-sel-off-month-range *ngSwitchCase="'5'" [soList]="soDOSAList" [doList]="doList" [saList]="saList"
				[buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(showReport)="onShowReport($event)">
			</app-mis-sel-off-month-range>

			<app-mis-sel-off-month-range-consolidate *ngSwitchCase="'6'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-month-range-consolidate>

			<app-mis-no-filter *ngSwitchCase="'7'" [buttonDisable]="isWaiting" (showReport)="onShowReport($event)">
			</app-mis-no-filter>

			<app-mis-sel-off-archetype-phase *ngSwitchCase="'8'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase>

			<app-mis-sel-off-consolidate-site *ngSwitchCase="'9'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-consolidate-site>

			<app-mis-sel-off-archetype-phase-quarter-index-site *ngSwitchCase="'10'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-quarter-index-site>

			<app-mis-sel-off-archetype-phase-quarter-index-parameter-site *ngSwitchCase="'11'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [parametersList]="parameterList" [buttonDisable]="isWaiting"
				(soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(indexChange)="onSelectIndex($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-quarter-index-parameter-site>

			<app-mis-sel-off-archetype-phase-quarter-index-consolidate-site *ngSwitchCase="'12'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-quarter-index-consolidate-site>

			<app-mis-sel-off-archetype-phase-quarter-site *ngSwitchCase="'13'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-quarter-site>

			<app-mis-sel-off-archetype-phase-index-site *ngSwitchCase="'14'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-index-site>

			<app-mis-sel-off-archetype-phase-site *ngSwitchCase="'15'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-site>

			<app-mis-sel-off-archetype-phase-index-param-site *ngSwitchCase="'16'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [parametersList]="parameterList" [buttonDisable]="isWaiting"
				(soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(indexChange)="onSelectIndex($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-index-param-site>

			<app-mis-sel-off-archetype-phase-year-site *ngSwitchCase="'17'" [soList]="soDOSAList" [doList]="doList"
				[saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-year-site>

			<app-mis-sel-off-archetype-phase-year-index-consolidate-site *ngSwitchCase="'18'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [buttonDisable]="isWaiting" (soChange)="onSelectSalesOrg($event)"
				(doChange)="onSelectSalesOff($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-year-index-consolidate-site>

			<app-mis-sel-off-archetype-phase-year-index-parameter-site *ngSwitchCase="'19'" [soList]="soDOSAList"
				[doList]="doList" [saList]="saList" [parametersList]="parameterList" [buttonDisable]="isWaiting"
				(soChange)="onSelectSalesOrg($event)" (doChange)="onSelectSalesOff($event)"
				(indexChange)="onSelectIndex($event)" (showReport)="onShowReport($event)">
			</app-mis-sel-off-archetype-phase-year-index-parameter-site>

		</div>
	</div>
</section>
<!-- Dashboard Header Section -->
<section class="dashboard-header">
	<div class="container-fluid">
		<div class="row" *ngIf="misReportValuesShow.reportHeaders != null && !isWaiting && !isReportExported">
			<!-- <div class="row" *ngIf="(misReportValues | async)?.reportHeaders != null"> -->
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header d-flex align-items-center">
						<h3 class="h4">Report Data</h3>
					</div>
					<div class="card-body">
						<div class="form-group">
							<!-- <div class="input-group"> -->
							<!-- <div class="input-group-prepend"> -->
							<button class="btn btn-primary" (click)="exportAsXLSX()">Export</button>
							<!-- </div> -->
							<!-- </div> -->
						</div>
						<cdk-virtual-scroll-viewport style="height: 500px;width: 100%" itemSize="10">
							<!-- <div style="overflow-x: auto"> -->
							<table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger"
								class="table table-striped table-hover">
								<thead>
									<tr>
										<th>Sr. No.</th>
										<th *ngFor="let header of misReportValuesShow.reportHeaders">{{header}}</th>
										<!-- <th *ngFor="let header of (misReportValues | async)?.reportHeaders">{{header}}</th> -->
									</tr>
								</thead>
								<!-- <tr *cdkVirtualFor="let rowData of (misReportValues | async)?.reportDatas | filter:searchText; let k = index;"> -->
								<tbody>
									<!-- <tr *ngFor="let rowData of misReportValuesShow.reportDatas | filter:searchText; let k = index;"> -->
									<tr *ngFor="let rowData of misReportValuesShow.reportDatas; let k = index;">
										<td title="Sr. No.">{{k + 1}}</td>
										<td *ngFor="let colData of rowData; let l = index;"
											[title]="misReportValuesShow.reportHeaders[l]">
											{{colData}}</td>
									</tr>
								</tbody>
							</table>
							<!-- </div> -->
						</cdk-virtual-scroll-viewport>
					</div>
				</div>
			</div>
		</div>
		<div class="row" *ngIf="misReportValuesShow.reportHeaders == null && isReportRequested && !isWaiting">
			<!-- <div class="row" *ngIf="(misReportValues | async)?.reportHeaders == null"> -->
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header d-flex align-items-center">
						<h3 class="h4">Report Data</h3>
					</div>
					<div class="card-body">
						<h3 class="h4">Nothing Found for this request <span style="font-size: 25px">ðŸ˜¢</span></h3>
					</div>
				</div>
			</div>
		</div>
		<div class="row" *ngIf="misReportValuesShow.reportHeaders == null && !isReportRequested && !isWaiting">
			<!-- <div class="row" *ngIf="(misReportValues | async)?.reportHeaders == null"> -->
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header d-flex align-items-center">
						<h3 class="h4">Report Data</h3>
					</div>
					<div class="card-body">
						<h3 class="h4">Press "Show" to Proceed</h3>
					</div>
				</div>
			</div>
		</div>
		<div class="row" *ngIf="isWaiting">
			<!-- <div class="row" *ngIf="(misReportValues | async)?.reportHeaders == null"> -->
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header d-flex align-items-center">
						<h3 class="h4">Report Data</h3>
					</div>
					<div class="card-body">
						<h3 class="h4">Please wait... Populating results <span style="font-size: 25px">ðŸ˜„</span></h3>
					</div>
				</div>
			</div>
		</div>
		<div class="row" *ngIf="(!isWaiting) && isReportRequested && isReportExported">
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header d-flex align-items-center">
						<h3 class="h4">Report Data</h3>
					</div>
					<div class="card-body">
						<h3 class="h4">File is being downloaded in your system. <span style="font-size: 25px">ðŸ˜„</span>
						</h3>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>